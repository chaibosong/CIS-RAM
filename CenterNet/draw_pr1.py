import logging
import tempfile
import os
import torch
import matplotlib.pyplot as plt
from collections import OrderedDict
from tqdm import tqdm
import numpy as np





# pr_array1=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
# 1,1,1, 0.99930891, 0.99930891, 0.99930891,
# 0.99930891, 0.99930891, 0.99930891, 0.99877825, 0.99877825, 0.99877825,
# 0.99841354, 0.99841354, 0.99841354, 0.99841354, 0.99841354, 0.99798995,
# 0.99798995, 0.99762018,0.99762018, 0.99733333, 0.99733333, 0.99733333,
# 0.99656505,0.99642857, 0.99642857, 0.99642857, 0.99611046, 0.99558174,
# 0.99558174, 0.99558174, 0.99516575, 0.99516575, 0.99516575, 0.99466844,
# 0.99466844, 0.99447873, 0.99447873, 0.99365079, 0.99322869,0.99322869,
# 0.99304716, 0.99287834, 0.99240654, 0.99200685, 0.99177538, 0.99167361,
# 0.99072559, 0.99045599, 0.99045599, 0.99012217, 0.98991466, 0.98954348,
# 0.98847695, 0.98839506, 0.98733869, 0.98698795, 0.986733, 0.98596819,
# 0.98509174, 0.98452083, 0.98378744, 0.98333333, 0.98233755, 0.98184924,
# 0.98184924, 0.9806275,  0.97940075, 0.97740345, 0.97544643, 0.97260548,
# 0.96981058, 0.96656948, 0.96319724, 0.95631708, 0.94723247, 0.93041607,
# 0.9041214,  0.83145009, 0,0,0]
# pr_array2=[1. ,        1. ,        1.  ,       1.,         1.  ,       1.
# , 1.,         1.,         1.    ,     1.       ,  1. ,        1.
#  ,1.,         1.  ,       1.     ,    1.        , 1.       ,  1.,
#  1.      ,   1.       ,  1. ,        0.99920319 ,0.99920319, 0.99855282,
#  0.99855282, 0.99855282, 0.99817851, 0.99817851, 0.99817851, 0.99817851,
#  0.99817851, 0.99817851, 0.99817851, 0.99817851 ,0.99817851, 0.99817851,
#  0.99817851, 0.99817851, 0.99817851, 0.99817851, 0.99817851, 0.99778369,
#  0.9965943 , 0.99626401, 0.9958575 , 0.99556273, 0.99453125, 0.99436725,
#  0.99436725, 0.99378655, 0.99347826 ,0.99295775, 0.99295538, 0.99295538,
#  0.99295538, 0.99215563, 0.99215563 ,0.99215563, 0.99198026, 0.99114774,
#  0.99071578, 0.99054653, 0.99007299, 0.98916762, 0.98876404, 0.98862375,
#  0.98804348, 0.98736559, 0.98567259, 0.98482549, 0.98482549, 0.98482549,
#  0.98423423, 0.98420533, 0.98334138, 0.98255675, 0.981569  , 0.98000465,
#  0.97864524, 0.977813  , 0.97609473, 0.9746696 , 0.97200521, 0.97026102,
#  0.96836111, 0.96487947, 0.96212121, 0.95767836, 0.95319318, 0.94740943,
#  0.9371189 , 0.92950636, 0.91965593, 0.90502495, 0.88425766, 0.85780423,
#  0.79056092, 0.68912591, 0.,         0.   ,      0.        ]

pr_array1=[1.,1., 0.99854651,
 0.99854651 ,0.99746193 ,0.99746193 ,0.99687174 ,0.99687174 ,0.99687174,
 0.99597586 ,0.99438202 ,0.99394856 ,0.99394856 ,0.99394856 ,0.99394856,
 0.99394856 ,0.99206349 ,0.99170124 ,0.99027868 ,0.98969072 ,0.98881988,
 0.98854732 ,0.98687664 ,0.98687664 ,0.98687664 ,0.98687664 ,0.98595787,
 0.98595787 ,0.98347107 ,0.98115874 ,0.98068966 ,0.9789615  ,0.97821351,
 0.97618035 ,0.97492807 ,0.97405756 ,0.97082847 ,0.97030467 ,0.96751307,
 0.96599634 ,0.96435002 ,0.95795375 ,0.95541838 ,0.95378433 ,0.95198948,
 0.9501287  ,0.94765058 ,0.94275162 ,0.93936652 ,0.93568282 ,0.93339125,
 0.92865232 ,0.91997792 ,0.91720779 ,0.9123411  ,0.90930353 ,0.90540541,
 0.90052356 ,0.89818449 ,0.89480019 ,0.88933459 ,0.88209506 ,0.87661017,
 0.86690172 ,0.85705073 ,0.84489967 ,0.83735186 ,0.82689243 ,0.81555469,
 0.8027134  ,0.78787879 ,0.76923077 ,0.75417661 ,0.73607231 ,0.70563512,
 0.67599823 ,0.64200774 ,0.60849851 ,0.55415646 ,0.50109478 ,0.45439252,
 0.38542974 ,0.3, 0,0,0, 0,0, 0., 0, 0., 0., 0.,0,0, 0., 0., 0., 0., 0, 0]

pr_array2=[1.0,1.,
1.0,
1.0,
1.0,
1,
1,
1,
1,
0.9980596813258427,
0.9980596813258427,
0.9980596813258427,
0.9980596813258427,
0.9980596813258427,
0.9980596813258427,
0.9975460229775281,
0.9975460229775281,
0.9975460229775281,
0.9975460229775281,
0.9946533463033708,
0.9946533463033708,
0.9946533463033708,
0.9946533463033708,
0.9941029574719101,
0.993339115,
0.993339115,
0.9912572968988764,
0.9906984810786517,
0.9900506675955056,
0.9900506675955056,
0.9890576453146067,
0.9878795360449438,
0.9871515398539326,
0.9865405470786517,
0.9849551724494382,
0.9840348442247191,
0.9829523460898877,
0.980700598752809,
0.980700598752809,
0.9784899848651686,
0.9763669972247191,
0.9753423150898877,
0.9727910938651686,
0.9705634726179775,
0.9664682087078652,
0.9642340281235955,
0.9624199789438203,
0.959615226258427,
0.9557352655955056,
0.9505366977303371,
0.9465047174382022,
0.9438835540112359,
0.9392608544382023,
0.9340226508539325,
0.9316438129775281,
0.9286087256067416,
0.924834481247191,
0.9177924238764046,
0.9120364928089888,
0.9052943243595506,
0.8975202106853932,
0.8911955390786517,
0.8873037950674157,
0.8805525229438201,
0.8739048739101123,
0.8694504434382022,
0.8648280145393259,
0.860896806235955,
0.8509056727191011,
0.8384547877977528,
0.8288585768988764,
0.8221278940561798,
0.808406500730337,
0.800072172752809,
0.7891759048539325,
0.7757681146067416,
0.7648081751235956,
0.7445706533370786,
0.7250472060674158,
0.7061267757078651,
0.6819050476179775,
0.6543514108764045,
0.6243410452584269,
0.5978401505393258,
0.561159597752809,
0.5169431335730337,
0.4507773140112359,
0.38147797191011235,
0.3160527439101124,
0.25616481443820227, 0.         ,0.     ,    0.     , 0.         ,0.     ,    0.     ,0.     ,    0.     , 0.         ,0.     ,    0.        ] 

pr_array3=[1., 1, 1,1., 1, 1,1,      1. , 1 ,       
 1.     ,     
 0.99890591 ,0.99890591 ,0.99890591, 0.99890591 ,0.99890591 ,0.99791014,
 0.99755501 ,0.99755501 ,0.99755501 ,0.99755501 ,0.99755501 ,0.99628529,
 0.99628529 ,0.995      ,0.99440168 ,0.99265688 ,0.99186992 ,0.99186992,
 0.99186519 ,0.99186519 ,0.99041173 ,0.98915401, 0.98777246 ,0.9872449,
 0.9868932  ,0.9868932  ,0.98474341 ,0.98474341 ,0.98425551 ,0.98423127,
 0.98287671 ,0.98123436, 0.97925986, 0.97754137, 0.9767712  ,0.97427166,
 0.9737717  ,0.97169811 ,0.96993279 ,0.96804446 ,0.9670068  ,0.96564376,
 0.96217802 ,0.95923567 ,0.95623632 ,0.95082468 ,0.9488942  ,0.94532164,
 0.94179743 ,0.93700787 ,0.93100605 ,0.92761033 ,0.92405063 ,0.92183848,
 0.91721686 ,0.91292415 ,0.9045532  ,0.89700285 ,0.89077783 ,0.8852646,
 0.87986577 ,0.8710946  ,0.86183369, 0.85481852 ,0.84731578 ,0.83419278,
 0.82622188 ,0.8133836  ,0.79595555 ,0.78231653 ,0.76134625 ,0.73647441,
 0.71173825 ,0.68375313 ,0.6529052  ,0.61009115 ,0.56970128 ,0.51157651,
 0.45270333 ,0.38539082 ,0.28083608 ,0.,      0.,
 0.        , 0. ,  0,   0   ,     0.,        0.    ,     0. ,     0.         ] 

pr_array4=[1., 1, 1, 1,1., 1, 1.,1., 1.,
0.99854651 ,0.99746193 ,0.99687174 ,0.99687174,
 0.99597586 ,0.99438202 ,0.99394856 ,0.99394856,
 0.99394856 ,0.99206349 ,0.99170124 ,0.99027868 ,0.98969072 ,0.98687664 ,
 0.98687664 ,0.98687664 ,0.98687664 ,0.98595787,
 0.98595787 ,0.98347107 ,0.98115874 ,0.98068966 ,0.9789615  ,0.97821351,
 0.97618035 ,0.97492807 ,0.97405756 ,0.97082847 ,0.97030467 ,0.96751307,
 0.96599634 ,0.96435002 ,0.95795375 ,0.95541838 ,0.95378433 ,0.95198948,
 0.9501287  ,0.94765058 ,0.94275162 ,0.93936652 ,0.93568282 ,0.93339125,
 0.92761033 ,0.92405063 ,0.92183848,
 0.91721686 ,0.91292415 ,0.9045532,
0.8975202106853932,
0.8911955390786517,
0.8873037950674157,
0.8805525229438201,
0.8739048739101123,
0.8694504434382022,
0.8648280145393259,
0.860896806235955,
0.8509056727191011,
0.8384547877977528,
0.8288585768988764,
0.8221278940561798,
0.808406500730337,
0.800072172752809,
0.7891759048539325,
0.7757681146067416,
0.7648081751235956,
0.7445706533370786,
0.7250472060674158,
0.7061267757078651,
0.6819050476179775,
0.6543514108764045,
0.6243410452584269,
0.5978401505393258,
0.561159597752809,
0.5169431335730337,
0.4507773140112359,
0.39,
0,
0,
0,      
 0   , 0., 0.  , 0       ,    0.     , 0.         ,0.     ,    0.     ,0.     ,    0.     , 0.         ,0.     ,    0
 ]

pr_array5=[1, 1, 1, 1.    ,1.,1.     ,    1.      , 1, 1,    1,  1.    ,     1.     ,    1.      ,   1.      , 
1.    ,     1.    ,     1.     ,    1.,    1.      , 1, 1,1.     ,    1.      , 1, 1,    
 0.99885584, 0.99885584 ,0.99885584 ,0.99885584,
 0.99885584 ,0.99885584, 0.99885584, 0.99885584 ,0.9978355  ,0.99593909,
 0.99494439 ,0.99469496 ,0.99469496 ,0.99398108 ,0.99183673 ,0.99151001,
 0.99151001 ,0.99151001 ,0.99151001 ,0.99151001 ,0.99151001 ,0.99151001,
 0.99130939 ,0.99130939 ,0.99068493 ,0.99068493 ,0.98784355 ,0.98712004,
 0.985      ,0.98355104 ,0.98282266 ,0.9825768 , 0.98052236 ,0.97950283,
 0.97701149 ,0.97391304 ,0.97068273, 0.96932757, 0.96733282 ,0.96401799,
 0.96184886 ,0.95898716, 0.95492662 ,0.95056256 ,0.94333996 ,0.94115745,
 0.93650794 ,0.93420236 ,0.9292868  ,0.92602496 ,0.91772885 ,0.90786137,
 0.90405294 ,0.89978448 ,0.89398734 ,0.8875999  ,0.87917609 ,0.85463054,
 0.84975398 ,0.82791325 ,0.81112231 ,0.80998217 ,0.76534542 ,0.7228275,
 0.70354188 ,0.66505562 ,0.63813002 ,0.50112975 ,0.41082944 ,
 0.         ,0.         ,0.        , 0.         ,0.         ,0., 
 0.    ] 


pr_array6=[1.       ,  1.,         1.,1.       ,         1.    ,     1. ,        1.,
 1.        , 1. , 
 0.99890591 ,0.99890591 ,0.99890591, 0.99890591 ,0.99890591 ,0.99791014,
 0.99755501 ,0.99755501 ,0.99755501 ,0.99755501 ,0.99755501 ,0.99628529,
 0.99628529 ,0.995      ,0.99440168 ,0.99265688 ,0.99186992 ,0.99186992,
 0.99186519 ,0.99186519 ,0.99041173 ,0.98915401, 0.98777246 ,0.9872449,
 0.9868932  ,0.9868932  ,0.98474341 ,0.98474341 ,0.98425551 ,0.98423127,
 0.98287671 ,0.98123436, 0.97925986, 0.97754137, 0.9767712  ,0.97427166,
 0.9737717  ,0.97169811 ,0.96993279 ,0.96804446 ,0.9670068  ,0.96564376,
 0.96217802 ,0.95923567 ,0.95623632 ,0.95082468 ,0.9488942  ,0.94532164,
 0.94179743 ,0.93700787 ,0.93100605 ,0.92761033 ,0.92405063 ,0.92183848,
 0.91721686 ,0.91292415 ,0.9045532  ,0.89556962 ,0.89127621 ,0.88669202 ,0.88292319,
 0.87478767 ,0.86818397 ,0.85981957 ,0.85374689 ,0.84470952 ,0.83415788,
 0.82139127 ,0.81168567 ,0.79802567 ,0.78460655 ,0.77156134 ,0.7639896,
 0.75045267 ,0.73244635 ,0.7111662  ,0.7061267757078651,
0.6819050476179775,
0.6543514108764045,
0.6243410452584269,
0.5978401505393258,
0.561159597752809,
0.5169431335730337,
0, 0        ,0. ,        0.   ,      0.,
 0.       ,  0.      ,   0.         ,0.    ]

pr_array1=np.array(pr_array1)
pr_array2 =np.array(pr_array2)
pr_array3 =np.array(pr_array3)
pr_array4 =np.array(pr_array4)
pr_array5 = np.array(pr_array5)

# pr_array5 =np.array(pr_array5)
# pr_array6 =np.array(pr_array6)
# pr_array4 =np.array(pr_array4)
#         pr_array3 = coco_eval.eval['precision'][2, :, 0, 0, 2]
#         pr_array4=coco_eval.eval['precision'][3,:,0,0,2]
#         pr_array5 = coco_eval.eval['precision'][4, :, 0, 0, 2]
#         pr_array6 = coco_eval.eval['precision'][5, :, 0, 0, 2]
#         pr_array7=coco_eval.eval['precision'][6,:,0,0,2]
#         pr_array8 = coco_eval.eval['precision'][7, :, 0, 0, 2]
#         pr_array9 = coco_eval.eval['precision'][8, :, 0, 0, 2]
#         pr_array10 = coco_eval.eval['precision'][9, :, 0, 0, 2]

#         pr_array10 =(pr_array1+pr_array2+pr_array3+pr_array4+pr_array5+pr_array6+pr_array7+pr_array8+pr_array9+pr_array10)/10

print('-----------------------------------')
# print(pr_array1,type(pr_array1))
#         print('-----------------------------------')
#         print(pr_array2)
#         print('----------------------------------')
#         print(pr_array3)

plt.plot([0,1],[0,1],'k-',label='Precision=Recall',linestyle='--')
x=np.arange(0.0,1.01,0.01)
plt.xlabel('Recall')
plt.ylabel('Precision')
plt.xlim(0,1.0)
plt.ylim(0,1.01)
plt.grid(True)

import scipy.signal
plt.plot(x, scipy.signal.savgol_filter(pr_array1, 3,1), 'g-', label='Faster RCNN')
plt.plot(x, scipy.signal.savgol_filter(pr_array4, 3,1), 'c-', label='CornerNet')

plt.plot(x,scipy.signal.savgol_filter(pr_array3, 3,1),'m-',label='Yolov4')
plt.plot(x, scipy.signal.savgol_filter(pr_array2, 3,1), 'b-', label='CenterNet')

plt.plot(x, scipy.signal.savgol_filter(pr_array5, 3,1), 'r-', label='CenterNet-PK')

# plt.plot(x, pr_array5, 'g-', label='Faster RCNN-Late')
# plt.plot(x, pr_array6, 'r-', label='MF Faster RCNN')

plt.legend(loc="lower left")
plt.savefig('./pr1.png', bbox_inches='tight', pad_inches=0, dpi=200)
plt.show()
print('结束')
